<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Localizar e Substituir em Tabelas"
        Height="450" Width="400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        Topmost="True"
        Background="#F9FAFB">

    <Window.Resources>
        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Seleção Tabela/Coluna -->
            <RowDefinition Height="Auto"/> <!-- Inputs Texto -->
            <RowDefinition Height="Auto"/> <!-- Opções -->
            <RowDefinition Height="*"/>    <!-- Espaço -->
            <RowDefinition Height="Auto"/> <!-- Botões -->
        </Grid.RowDefinitions>

        <!-- 1. SELEÇÃO DE CONTEXTO -->
        <GroupBox  Grid.Row="0" BorderBrush="#999">
            <StackPanel>

                <!-- Dropdown de Tabelas -->
                <TextBlock Text="Selecione a Tabela/Planilha:" Margin="0,0,0,2" FontWeight="Normal"/>
                <ComboBox x:Name="cb_schedules" Height="25" Margin="0,0,0,10"
                          IsEditable="False"/>

                <!-- Dropdown de Colunas -->
                <TextBlock Text="Selecione a Coluna (Parâmetro):" Margin="0,0,0,2" FontWeight="Normal"/>
                <ComboBox x:Name="cb_columns" Height="25" Margin="0,0,0,5"
                          IsEnabled="False" IsEditable="False"/>

                <TextBlock x:Name="lbl_info" Text="Aguardando seleção..." FontSize="10" Foreground="Gray" FontStyle="Italic"/>
            </StackPanel>
        </GroupBox>

        <!-- 2. INPUTS DE TEXTO -->
        <GroupBox Header="Texto" Grid.Row="1" BorderBrush="#999">
            <StackPanel>
                <Label Content="Localizar :" FontWeight="Normal" Padding="0,5,0,0"/>
                <TextBox x:Name="tb_find" Height="25" VerticalContentAlignment="Center" Margin="0,0,0,5"/>

                <Label Content="Substituir por:" FontWeight="Normal" Padding="0,5,0,0"/>
                <TextBox x:Name="tb_replace" Height="25" VerticalContentAlignment="Center"/>
            </StackPanel>
        </GroupBox>

        <!-- 3. OPÇÕES -->
        <GroupBox Header="Configurações" Grid.Row="2" BorderBrush="#999">
            <StackPanel>
                <CheckBox x:Name="cb_match_case" Content="Diferenciar Maiúsculas (Case Sensitive)"
                          VerticalContentAlignment="Center" FontWeight="Normal" Margin="0,0,0,5"/>
                <CheckBox x:Name="cb_use_regex" Content="Usar Expressões Regulares (Regex)"
                          VerticalContentAlignment="Center" FontWeight="Normal"/>
            </StackPanel>
        </GroupBox>

        <!-- 4. BOTÕES -->
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button x:Name="btn_cancel" Content="Cancelar" Grid.Column="0" Height="35" Margin="0,0,3,0" Click="cancel_click"/>
            <Button x:Name="btn_preview" Content="Preview" Grid.Column="1" Height="35" Margin="3,0,3,0"
                    Click="preview_click" Background="#28A745" Foreground="White" FontWeight="Bold"/>
            <Button x:Name="btn_ok" Content="Substituir" Grid.Column="2" Height="35" Margin="3,0,0,0"
                    Click="replace_click" Background="#007ACC" Foreground="White" FontWeight="Bold"/>
        </Grid>
    </Grid>
</Window>
